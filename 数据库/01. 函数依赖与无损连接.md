## 🧩 在关系型数据库中，什么是分解关系模式？

在关系型数据库中，**分解关系模式** 是规范化设计中的重要步骤。我们通常把一个复杂的关系拆成几个更小的关系（表），但分解后要**满足两个关键性质**：

1. 🔗 **保持函数依赖（Dependency Preservation）**  
2. 🛠️ **无损连接（Lossless Join）**

---

## 📌 1. 保持函数依赖

### ❓ 什么是保持函数依赖？

- ✅ 分解后的关系模式的**并集**能够**保留原始关系中的所有函数依赖**。
- ❌ 如果某些函数依赖在分解后无法推导出来，那就说明它**不保持依赖**。

---

### 🧮 判断步骤

1. 📋 **列出原始函数依赖集**：  
   假设原始关系模式 `R` 的函数依赖集为 `F`。

2. ✂️ **列出分解后的关系模式**：  
   比如分解为 `R1, R2, ..., Rn`。

3. 🔍 **投影依赖集到每个子关系**：  
   得到 `F1, F2, ..., Fn`。

4. ✅ **合并投影后的依赖集**，看是否能推导出原始依赖 `F`：
   - 如果 `F ⊆ F1 ∪ F2 ∪ ... ∪ Fn`，说明保持函数依赖。
   - 否则，就不保持。

---

### 📚 示例讲解

假设关系 `R(U) = {A, B, C}`，函数依赖集 `F = {A → B, B → C}`。

#### ✔️ 分解 1：  
`R1 = {A, B}`，`R2 = {B, C}`  
- `F1 = {A → B}`  
- `F2 = {B → C}`  
✅ `F1 ∪ F2` 能推导出 `F`，保持函数依赖！

#### ❌ 分解 2：  
`R1 = {A, B}`，`R2 = {A, C}`  
- `F1 = {A → B}`  
- `F2 = {}`（`A → C` 不存在）  
❌ `B → C` 无法恢复，不保持函数依赖！

---

## 🧱 2. 无损连接

### ❓ 什么是无损连接？

- ✅ 分解后的子关系**通过自然连接可以恢复原始关系**。
- ❌ 如果连接后结果**多了或少了元组**，就是有损连接。

---

### 🧪 判断方法

#### ✅ 方法一：**Chase 算法**（进阶）
构造表格、运用依赖推导，这里略去。

#### ✅ 方法二（简单好记）：
> **只要分解后的某个子关系包含候选键，就一定无损连接！** 🎯

---

### 📚 示例讲解

假设关系 `R(U) = {A, B, C}`，`F = {A → B, B → C}`，候选键为 `{A}`。

#### ✔️ 分解 1：`{A, B}` 和 `{B, C}`  
`{A, B}` 包含候选键 `{A}` → ✅ 无损

#### ✔️ 分解 2：`{A, B}` 和 `{A, C}`  
`{A, B}` 包含候选键 `{A}` → ✅ 无损

#### ✔️ 分解 3：`{A, B}` 和 `{C}`  
`{A, B}` 还是包含候选键 `{A}` → ✅ 无损

---

## 🧾 3. 总结回顾

| 属性        | 说明          | 如何判断                            |
|-----------|-------------|---------------------------------|
| 🔗 保持函数依赖 | 保留所有原始依赖    | 看 `F1 ∪ F2 ∪ ... ∪ Fn` 是否 ⊇ `F` |
| 🛠️ 无损连接  | 原始关系可以无误地恢复 | 有一个子关系包含候选键即可 ✅                 |

🎉 **Tips：规范化不是越细越好！**  
一定要在 **冗余少 + 无损连接 + 依赖保持** 三者中做平衡。
