😃 **McCabe 复杂度度量法**（也叫**环形复杂度 Cyclomatic Complexity**）是一种常见的代码复杂度度量方法，主要用于衡量程序的*
*可测试性**和**可维护性**。

它的核心思想是：  
**程序的控制流图（CFG）中，独立路径的数量决定了代码的复杂度**。

---

## **📌 1. 计算 McCabe 复杂度的公式**

McCabe 复杂度（`V(G)`）的计算公式如下：

$$
V(G) = E - N + 2P
$$

其中：

- `E` = 控制流图中的 **边（Edges）**
- `N` = 控制流图中的 **节点（Nodes）**
- `P` = **连通分量**（通常对于一个程序 `P=1`，除非是多个不相连的代码块）

换句话说，McCabe 复杂度**等于代码的决策结构数**（如 `if`、`while`、`for`、`case` 等）加上 1。

---

## **📌 2. 计算步骤**

想要计算 McCabe 复杂度，通常遵循以下 **3 步**：

### **✅ 第 1 步：画出程序的控制流图**

- 每个代码块（基本块）作为 **一个节点**
- 代码流的跳转（`if`、`for`、`while` 等）作为 **边**

### **✅ 第 2 步：统计公式中的变量**

- **数边数（E）**：代码的流程线条
- **数节点数（N）**：代码的基本块数量
- **确定连通分量（P）**：一般来说 `P=1`（只有一个完整程序）

### **✅ 第 3 步：代入公式计算**

- `V(G) = E - N + 2P`
- 计算得出 McCabe 复杂度

---

## **📌 3. 举例**

### **示例代码**

```java
public String exampleMethod(int x) {
    Sting result;
    if (x > 0) {
        result = "Positive";
    } else if (x < 0) {
        result = "Negative";
    } else {
        result = "Zero";
    }

    return result;
}
```

### **✅ 第 1 步：画控制流图**

控制流如下：

```plaintext      
    <x > 0?>
    /     \
  Y/       \ N
  |         |
"Positive"  <x < 0?>
     |       /     \
     |     Y/       \ N
     |     |         |
     |  "Negative"  "Zero"
      \      \      /
          [Return]
```

### **✅ 第 2 步：统计变量**

- **节点数（N）**：
    - 开始节点
    - `if` 语句
    - `else if` 语句
    - `else` 语句
    - 结束

  **N = 6**

- **边数（E）**：
    - 进入 `if`
    - `if` 条件满足（`Yes`）
    - `if` 条件不满足，进入 `else if`
    - `else if` 条件满足（`Yes`）
    - `else if` 条件不满足，进入 `else`
    - `else` 结束

  **E = 7**

- **连通分量（P）**：
    - 只有一个代码块，**P = 1**

### **✅ 第 3 步：计算 McCabe 复杂度**

$$
V(G) = E - N + 2P
$$
$$
V(G) = 7 - 6 + 2(1) = 3
$$

**最终复杂度：3**

---

## **📌 4. McCabe 复杂度的解读**

| **McCabe 复杂度值** | **代码的解读**                |
|-----------------|--------------------------|
| `1 - 10`        | **简单代码**，易于测试和维护 👍      |
| `11 - 20`       | **适中复杂**，可以维护，但可能需要优化 ⚠  |
| `21 - 50`       | **复杂代码**，难以测试和维护，需要重构 🚨 |
| `> 50`          | **极度复杂**，不可维护，必须拆分 ⚡     |

如果 McCabe 复杂度过高，建议：

- **拆分方法**，减少 `if` 和 `switch` 嵌套
- **使用策略模式**，降低 `if-else` 结构
- **优化循环**，避免深层次 `for/while` 嵌套

---

## **📌 5. 总结**

- **McCabe 复杂度** 主要衡量代码的**路径数量**，影响测试和维护成本
- **核心公式**：`V(G) = E - N + 2P`
- **计算方法**：
    1. **画控制流图**
    2. **统计 `E`、`N`、`P`**
    3. **代入公式**
- **理想范围**：`1-10`，超过 `20` 需优化 🚀

如果代码 McCabe 复杂度过高，意味着**测试难度大，容易出 bug**，所以**要尽量降低复杂度**！💡
